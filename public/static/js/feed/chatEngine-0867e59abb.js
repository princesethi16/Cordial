class ChatEngine{constructor(e,i,s){this.chatBox=$(` #${e}`),this.userEmail=i,this.userFriendshipId=s,this.socket=io.connect("http://localhost:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let s=this;this.socket.on("connect",function(){console.log("connection established using sockets...!"),s.socket.emit("join_room",{user_email:s.userEmail,chatRoom:`${s.userFriendshipId}`}),s.socket.on("user_joined",function(e){console.log("a user joined",e)});let e=$(`#input-message-div-${s.userFriendshipId}`);e.keypress(function(){s.socket.emit("userTyping",{user_email:s.userEmail,chatRoom:`${s.userFriendshipId}`,isTyping:!0})}),s.socket.on("friendTyping",function(e){console.log("friend typing"),s.userEmail!=e.user_email&&friendTyping(e)}),e.focusout(function(){s.socket.emit("userStoppedTyping",{user_email:s.userEmail,chatRoom:`${s.userFriendshipId}`,isTyping:!1})}),s.socket.on("friendStoppedTyping",function(e){console.log("frind typing stoppped"),s.userEmail!=e.user_email&&friendTyping(e)});let i=$(`#send-message-${s.userFriendshipId}`);i.click(function(){let e=$(`#input-message-div-${s.userFriendshipId}`);var i=e.val();""!=i&&(e.val(""),s.socket.emit("send_message",{user_email:s.userEmail,chatRoom:`${s.userFriendshipId}`,msg:i}))}),s.socket.on("recieve_message",function(e){console.log(e),addMsgToChat(s.userEmail,e)})})}}function addMsgToChat(e,i){let s="incoming";e==i.user_email&&(s="outgoing");let n=$(`#chat_box_collapse-${i.chatRoom}`);console.log(n);let o=n.find(".body");o.prepend(`
        <li class="${s}">
            <div class="bubble">
                <p>${i.msg}</p>
            </div>
        </li>
    `)}function friendTyping(e){let i=$(`#chat_box_collapse-${e.chatRoom}`),s=i.find(".typing");e.isTyping?s.removeClass("hide"):s.addClass("hide")}