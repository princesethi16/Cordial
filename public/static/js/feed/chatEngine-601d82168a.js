class ChatEngine{constructor(e,i,s){this.chatBox=$(` #${e}`),this.userEmail=i,this.userFriendshipId=s,this.socket=io.connect("http://localhost:5000"),this.userEmail&&this.connectionHandler()}connectionHandler(){let e=this;this.socket.on("connect",(function(){console.log("connection established using sockets...!"),e.socket.emit("join_room",{user_email:e.userEmail,chatRoom:`${e.userFriendshipId}`}),e.socket.on("user_joined",(function(e){console.log("a user joined",e)}));let i=$(`#input-message-div-${e.userFriendshipId}`);i.keypress((function(){e.socket.emit("userTyping",{user_email:e.userEmail,chatRoom:`${e.userFriendshipId}`,isTyping:!0})})),e.socket.on("friendTyping",(function(i){console.log("friend typing"),e.userEmail!=i.user_email&&friendTyping(i)})),i.focusout((function(){e.socket.emit("userStoppedTyping",{user_email:e.userEmail,chatRoom:`${e.userFriendshipId}`,isTyping:!1})})),e.socket.on("friendStoppedTyping",(function(i){console.log("frind typing stoppped"),e.userEmail!=i.user_email&&friendTyping(i)})),$(`#send-message-${e.userFriendshipId}`).click((function(){let i=$(`#input-message-div-${e.userFriendshipId}`),s=i.val();""!=s&&(i.val(""),e.socket.emit("send_message",{user_email:e.userEmail,chatRoom:`${e.userFriendshipId}`,msg:s}))})),e.socket.on("recieve_message",(function(i){console.log(i),addMsgToChat(e.userEmail,i)}))}))}}function addMsgToChat(e,i){let s="incoming";e==i.user_email&&(s="outgoing");let n=$(`#chat_box_collapse-${i.chatRoom}`);console.log(n),n.find(".body").prepend(`\n        <li class="${s}">\n            <div class="bubble">\n                <p>${i.msg}</p>\n            </div>\n        </li>\n    `)}function friendTyping(e){let i=$(`#chat_box_collapse-${e.chatRoom}`).find(".typing");e.isTyping?i.removeClass("hide"):i.addClass("hide")}